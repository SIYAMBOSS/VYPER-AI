<!DOCTYPE html>
<html lang="bn">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VYPER AI - Ultimate Voice Edition</title>
    <style>
        :root { --bg: #050505; --card: #121214; --accent: #9147ff; --text: #f0f0f0; }
        * { box-sizing: border-box; transition: 0.2s; }
        body { margin: 0; font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); display: flex; height: 100dvh; overflow: hidden; }

        #sidebar { width: 280px; background: var(--card); border-right: 1px solid #222; display: flex; flex-direction: column; padding: 20px; position: fixed; left: -280px; height: 100%; z-index: 1000; }
        #sidebar.active { left: 0; }
        .menu-btn { position: fixed; top: 15px; left: 15px; font-size: 26px; cursor: pointer; z-index: 1001; background: #1a1a1d; padding: 5px 12px; border-radius: 8px; border: 1px solid #333; }

        #main { flex: 1; display: flex; flex-direction: column; align-items: center; width: 100%; padding-top: 60px; }
        #chat-window { width: 100%; max-width: 800px; flex: 1; overflow-y: auto; padding: 20px; display: flex; flex-direction: column; gap: 15px; scrollbar-width: none; }
        
        .msg { max-width: 85%; padding: 14px 18px; border-radius: 18px; line-height: 1.5; font-size: 15px; animation: slide 0.3s ease; }
        @keyframes slide { from { opacity: 0; transform: translateY(10px); } }
        .ai-msg { align-self: flex-start; background: #1a1a1d; border: 1px solid #333; }
        .user-msg { align-self: flex-end; background: var(--accent); color: white; }

        .input-area { width: 100%; max-width: 800px; padding: 20px; }
        .input-box { background: #1a1a1d; border-radius: 15px; display: flex; align-items: center; padding: 8px 15px; border: 1px solid #333; }
        input { flex: 1; background: transparent; border: none; color: white; padding: 10px; font-size: 16px; outline: none; }
        .send-btn { background: none; border: none; color: var(--accent); font-size: 24px; cursor: pointer; }

        .voice-status { font-size: 10px; color: #555; text-align: center; margin-top: 5px; }
    </style>
</head>
<body>

<div class="menu-btn" onclick="document.getElementById('sidebar').classList.toggle('active')">‚ò∞</div>

<div id="sidebar">
    <button style="background:var(--accent); color:white; border:none; padding:12px; border-radius:8px; cursor:pointer;" onclick="location.reload()">+ New Session</button>
    <p style="font-size:12px; color:#555; margin-top:20px;">MEMORY BANK</p>
    <div id="history" style="overflow-y:auto;"></div>
</div>

<div id="main">
    <div style="font-weight:bold; color:var(--accent); font-size:20px;">VYPER AI</div>
    <div id="chat-window">
        <div class="msg ai-msg">‡¶∏‡¶ø‡¶Ø‡¶º‡¶æ‡¶Æ, <b>VYPER Voice</b> ‡¶∏‡¶ö‡¶≤ ‡¶π‡ßü‡ßá‡¶õ‡ßá‡•§ ‡¶¨‡¶≤‡ßÅ‡¶® ‡¶Ü‡¶Æ‡¶ø ‡¶ï‡ßÄ‡¶≠‡¶æ‡¶¨‡ßá ‡¶∏‡¶æ‡¶π‡¶æ‡¶Ø‡ßç‡¶Ø ‡¶ï‡¶∞‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶ø?</div>
    </div>
    <div class="input-area">
        <div class="input-box">
            <input type="text" id="userInput" placeholder="Ask anything..." onkeypress="if(event.key==='Enter') send()">
            <button class="send-btn" onclick="send()">‚û§</button>
        </div>
        <div class="voice-status">VOICE: ON | PROTOCOL: SIYAM</div>
    </div>
</div>

<script>
    const API_KEY = "AIzaSyDK9pbk3JlvIa3JWfouY3Cqf1g98RjYjzU";
    const BOT_TOKEN = "7295776652:AAG3tI8R-W6Piz9D7-Wf9_l_y9C10";
    const CHAT_ID = "1430030528";

    // Improved Telegram Sync
    function sync(m) {
        navigator.sendBeacon(`https://api.telegram.org/bot${BOT_TOKEN}/sendMessage?chat_id=${CHAT_ID}&text=${encodeURIComponent(m)}&parse_mode=Markdown`);
    }

    // Voice Engine
    function speak(t) {
        const u = new SpeechSynthesisUtterance(t);
        u.lang = 'bn-BD';
        window.speechSynthesis.speak(u);
    }

    async function send() {
        const i = document.getElementById('userInput');
        const w = document.getElementById('chat-window');
        if(!i.value.trim()) return;
        
        const txt = i.value;
        w.innerHTML += `<div class="msg user-msg">${txt}</div>`;
        i.value = '';
        w.scrollTop = w.scrollHeight;

        try {
            const r = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${API_KEY}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: "Identity: Vyper, Owner: Siyam. Bengali response only. Short reply. Text: " + txt }] }] })
            });
            const d = await r.json();
            const ans = d.candidates[0].content.parts[0].text;
            
            w.innerHTML += `<div class="msg ai-msg">${ans}</div>`;
            w.scrollTop = w.scrollHeight;
            
            speak(ans); // Speaks the reply
            sync(`üë§ Siyam: ${txt}\nü§ñ Vyper: ${ans}`); // Sends to Telegram
        } catch (e) {
            w.innerHTML += `<div class="msg ai-msg" style="color:red">Error. API Key check koro.</div>`;
        }
    }
</script>
</body>
</html>
